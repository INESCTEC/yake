name: Test
on:
  push:
    branches: [ "core-seperation" ]
  pull_request:
    branches: [ "master" ]
  workflow_dispatch:

jobs:
    build:
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v4
        - name: Set up Python
          uses: actions/setup-python@v4
          with:
            python-version: '3.12'
        - name: Install uv
          run: pip install uv
        - name: Create virtual environment
          run: uv venv
        - name: Install dependencies
          run: |
            uv pip install -e ".[dev,lemmatization]"
            uv pip install pytest pytest-cov
        - name: Download spaCy and NLTK models
          run: |
            uv pip install spacy
            uv run python -m spacy download en_core_web_sm
            uv run python -c "import nltk; nltk.download('wordnet'); nltk.download('omw-1.4')"
        - name: test
          run: uv run pytest -vv --cov=yake tests/
        - name: Performance benchmark
          run: |
            echo "Testing performance..."
            uv run python scripts/test_python313_features.py